<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Welcome to Måla</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --bg-color: #f2f4f3;
            --text-color: #1f2a2e;
            --accent-color: #4f6f64;
            --card-bg: #ffffff;
            --border-color: #d0d6d4;
            --active-bg: rgba(79, 111, 100, 0.12);
            --audio-bg: #eef2f1;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #0f1a1c;
                --text-color: #e4ecea;
                --accent-color: #7fa89c;
                --card-bg: #162326;
                --border-color: #2b3a3e;
                --active-bg: rgba(127, 168, 156, 0.18);
                --audio-bg: #1b2b2f;
            }
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.7;
        }

        main {
            max-width: 760px;
            margin: 0 auto;
            padding: 1.5rem 1.25rem 3rem;
        }

        h1 {
            color: var(--accent-color);
            font-size: clamp(1.8rem, 4vw, 2.4rem);
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 1.75rem;
            margin-top: 1.75rem;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
        }

        /* Audio Player */
        .audio-player {
            background-color: var(--audio-bg);
            border-radius: 8px;
            padding: 1rem 1.25rem 1.25rem;
            margin: 1.5rem 0;
            border: 1px solid var(--border-color);
        }

        .audio-player h2 {
            font-size: 0.95rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            margin: 0 0 0.75rem;
            color: var(--accent-color);
        }

        audio {
            width: 100%;
            accent-color: var(--accent-color);
        }

        /* Collapsible Transcript */
        details.transcript {
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
            padding-top: 1rem;
        }

        details.transcript summary {
            cursor: pointer;
            list-style: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Hide default marker */
        details.transcript summary::-webkit-details-marker {
            display: none;
        }

        /* Custom caret */
        details.transcript summary::before {
            content: "▸";
            display: inline-block;
            transition: transform 0.3s ease;
        }

        details.transcript[open] summary::before {
            transform: rotate(90deg);
        }

        .transcript-content {
            margin-top: 1rem;
        }

        .transcript-content p {
            margin: 0 0 0.75rem;
            padding: 0.5rem 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.4s ease;
        }

        .transcript-content p.active {
            background-color: var(--active-bg);
        }

        .transcript-content p:focus-visible,
        details summary:focus-visible {
            outline: 3px solid var(--accent-color);
            outline-offset: 2px;
        }
    </style>
</head>
<body>

<main>
    <h1>Welcome to Måla</h1>
    <p>
        Welcome to Måla, a small fictional town in southern Sweden, surrounded by pine forests,
        quiet lakes, and roads that seem to remember every footstep. This audio tour will guide
        you through the town and its subtle history.
    </p>

    <div class="card">
        <div class="audio-player" role="group" aria-labelledby="audio-title">
            <h2 id="audio-title">Audio Tour</h2>
            <audio id="audio" controls aria-label="Audio tour of the town of Måla">
                <source src="path-to-audio-file.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        </div>

        <details class="transcript">
            <summary>Audio Transcript</summary>

            <div class="transcript-content">
                <p tabindex="0" data-start="0">
                    The road into Måla is long and quiet, bordered by pine trees that rarely move.
                </p>
                <p tabindex="0" data-start="14">
                    On winter mornings, the air carries a stillness that makes every sound feel closer.
                </p>
                <p tabindex="0" data-start="29">
                    The bus stop has not changed much in decades, though fewer people wait there now.
                </p>
                <p tabindex="0" data-start="45">
                    If you listen carefully, you may notice how the town seems to speak only when no one else does.
                </p>
            </div>
        </details>
    </div>
</main>

<script>
    const audio = document.getElementById('audio');
    const transcriptLines = Array.from(document.querySelectorAll('.transcript-content p'));

    function updateTranscript() {
        const currentTime = audio.currentTime;
        let activeLine = null;

        for (let i = 0; i < transcriptLines.length; i++) {
            const start = parseFloat(transcriptLines[i].dataset.start);
            const nextStart = transcriptLines[i + 1]
                ? parseFloat(transcriptLines[i + 1].dataset.start)
                : Infinity;

            if (currentTime >= start && currentTime < nextStart) {
                activeLine = transcriptLines[i];
                break;
            }
        }

        transcriptLines.forEach(line => {
            line.classList.toggle('active', line === activeLine);
        });

        if (activeLine) {
            activeLine.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    }

    audio.addEventListener('timeupdate', updateTranscript);

    transcriptLines.forEach(line => {
        line.addEventListener('click', () => {
            audio.currentTime = parseFloat(line.dataset.start);
            audio.play();
        });

        line.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                audio.currentTime = parseFloat(line.dataset.start);
                audio.play();
            }
        });
    });
</script>

</body>
</html>
